pipeline {
    agent {
        docker {
            image 'postman/newman'
            args '-u 0:0' // Optionnel : Utilisé si des permissions spécifiques sont nécessaires
        }
    }
    stages {
        stage('Run Newman Collection') {
            steps {
                script {
                    // Lancer la commande Docker pour exécuter la collection Newman
                    sh '''
                        docker run -v ${WORKSPACE}:/etc/newman \
                        --workdir /etc/newman \
                        -t postman/newman \
                        run collection-1.json --color off --disable-unicode
                    '''
                }
            }
        }
    }
    post {
        always {
            echo 'Pipeline completed!'
        }
    }
}
